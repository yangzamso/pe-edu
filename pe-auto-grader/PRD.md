# PRD: 엑셀 자동채점 웹앱 (v2.0)

## 1. 프로젝트 개요

### 1.1 목적
- 엑셀 파일의 답안 시트를 분석하여 색상 기반으로 자동 채점하는 Streamlit 웹 애플리케이션
- 수동 채점의 번거로움을 없애고, 채점 결과를 원본 엑셀 구조 그대로 유지하며 점수화하여 반환

### 1.2 핵심 가치
- **색상 기반 자동화**: 셀 배경색(RGB)을 인식하여 즉시 점수로 변환
- **원본 구조 유지**: 채점 후에도 학생 정보와 엑셀 레이아웃을 그대로 보존
- **직관적인 사용**: 파일 업로드 → 채점 → 다운로드의 단순한 프로세스

---

## 2. 채점 기준 및 로직

### 2.1 색상 인식 기준 (RGB)
실제 엑셀 파일 분석을 통해 확정된 색상 값입니다. (허용 오차 ±30)

| 색상 | RGB 값 | Hex 코드 | 의미 |
|------|--------|----------|------|
| **초록** | (182, 215, 168) | #B6D7A8 | 만점 |
| **노랑** | (255, 229, 153) | #FFE599 | 부분 점수 |
| **빨강** | (234, 153, 153) | #EA9999 | 0점 |

### 2.2 배점 구조 (총 100점)

#### 객관식 (E열 ~ N열)
- **문항 수**: 10문항
- **배점**:
  - 🟢 초록: **2.5점**
  - 🟡 노랑: **1.25점**
  - 🔴 빨강: **0점**
- **합계 위치**: O열

#### 주관식 (P열 ~ AD열)
- **문항 수**: 15문항
- **배점**:
  - 🟢 초록: **5.0점**
  - 🟡 노랑: **2.5점**
  - 🔴 빨강: **0점**
- **합계 위치**: AE열

#### 총점 위치
- **위치**: AF열 (객관식 합계 + 주관식 합계)

---

## 3. 기능 요구사항

### 3.1 파일 업로드 및 분석
- **입력**: `.xlsx` 형식의 엑셀 파일
- **처리**:
  - 첫 번째 시트(또는 지정된 답안 시트) 자동 로드
  - 2행부터 데이터 행으로 인식
  - 빈 행이나 이름이 없는 행은 자동으로 건너뜀

### 3.2 자동 채점 프로세스
1. **행 순회**: 각 학생(행)별로 채점 진행
2. **색상 추출**: 답안 셀의 배경색 RGB 값 추출
3. **점수 매핑**: 추출된 색상을 기준표와 비교하여 점수 부여
4. **결과 집계**: 객관식/주관식 합계 및 총점 계산

### 3.3 결과 표시 (웹 UI)

- **요약 리스트**: 
  - 원본 엑셀의 순서(행 번호)를 그대로 유지하여 표시
  - 표시 항목: 


### 3.4 결과 다운로드 (핵심 기능)
- **형식**: **원본 엑셀 파일의 구조 완벽 유지**
- **데이터 변환**: 
  - 색칠된 답안 셀의 값을 해당 점수(예: 2.5, 5.0)로 계산(색상은 유지됨)
  - 다른 열은 그대로 원본 값 그대로 유지
  - **O열**: 객관식 점수 합계 기입
  - **AE열**: 주관식 점수 합계 기입
  - **AF열**: 객관식 + 주관식 점수 합계 기입 (수식으로 계산)
- **출력 파일명**: `채점결과_YYYYMMDD.xlsx`

---

## 4. 기술 스택 및 환경

### 4.1 개발 환경
- **Language**: Python 3.8+
- **Framework**: Streamlit (웹 UI)
- **Libraries**:
  - `openpyxl`: 엑셀 파일 읽기/쓰기, 스타일(색상) 분석 (필수)
  - `pandas`: 데이터 구조화 및 화면 표시

### 4.2 프로젝트 구조
```
pe-auto-grader/
├── app.py              # 메인 웹 애플리케이션
├── grader.py           # 핵심 채점 로직 및 엑셀 생성 클래스
├── requirements.txt    # 의존성 패키지 목록
└── PRD.md              # 기획 문서
```

---


## 5. 예외 처리 및 제약 사항

- **색상 오차**: 스캔이나 버전 차이로 인한 미세한 RGB 차이를 보정하기 위해 ±30의 허용 오차 적용
- **데이터 유효성**: 학생 이름이 없는 행은 무시
- **파일 형식**: `.xlsx`만 지원 (구형 `.xls` 미지원)
